---
#layout: layouts/base.njk
templateClass: tmpl-post
---
{% extends "layouts/base.njk" %}


{% block extraArticleHeader %}
   <h2>{{ title }}</h2>
   {% set wc = content | striptags | wordcount %}
   {% set wPerMinute = (wc / 240) + 1 %}
   <aside>{{ wPerMinute | round }} min read.</aside>
{% endblock %}

{% block article %}
<!-- Table of Contents -->
{% set headings = extractMarkdownHeadings(content) %}
<!-- Debug: Found {{ headings.length }} headings -->
{% if headings.length > 0 %}
<div class="toc">
  <h3>Table of Contents</h3>
  <nav class="toc-nav">
    {% for heading in headings %}
      <a href="#{{ heading.id }}" class="toc-link toc-level-{{ heading.level }}">
        {{ heading.text }}
      </a>
    {% endfor %}
  </nav>
</div>
{% else %}
<!-- Debug: No headings found. Content length: {{ content | length }} -->
<!-- Content preview: {{ content | truncate(200) }} -->
{% endif %}

{{ content | safe }}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "image": [],
  "author": "{{ metadata.author.name }}", 
  "genre": "{{ metadata.genre }}", 
  "publisher": {
    "@type": "Organization",
    "name": "{{ metadata.publisher.name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ '/img/favicon/favicon-192x192.png' | addHash }}"
    }
  },
  "url": "{{ metadata.url }}{{ canonicalUrl or page.url }}",
  "mainEntityOfPage": "{{ metadata.url }}{{ canonicalUrl or page.url }}",
  "datePublished": "{{ page.date | htmlDateString }}",
  "dateModified": "{{ page.inputPath | lastModifiedDate  | htmlDateString }}",
  "description": "{{ content | striptags | truncate(140) }}"
}
</script>

{% endblock %}

{% block footer %}
  <span>&copy; 2025 Yangyue (Locke) Wang</span>
{% endblock %}
